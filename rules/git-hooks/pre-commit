#!/bin/bash
# SpecSafe pre-commit hook

echo "üîç Running SpecSafe pre-commit validation..."

# Check PROJECT_STATE.md exists
if [ ! -f "PROJECT_STATE.md" ]; then
    echo "‚ùå PROJECT_STATE.md not found"
    echo "   Run 'specsafe init' to set up your project"
    exit 1
fi

# Check for TODO markers in staged files only (NUL-delimited for safe filenames)
if git diff --cached --name-only -z --diff-filter=ACM -- '*.ts' '*.js' | xargs -0 grep -l "TODO.*spec" 2>/dev/null | head -1 >/dev/null; then
    echo "‚ö†Ô∏è  Found TODO items mentioning specs - review before committing"
fi

echo "‚úÖ SpecSafe pre-commit checks passed"
