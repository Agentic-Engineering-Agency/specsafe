# SpecSafe v0.6.x Stabilization & Merge-Readiness Report

Date: 2026-02-12
Base branch: `main`
Assessed branches:
- `feat/story-context-capsules` (`5f31d11`)
- `feat/project-memory` (`8634fd5`)
- `feat/dual-format-export` (`dde9e3f`)
- `feat/spec-sharding` (`3409a27`)
- `feat/e2e-testing-system` (`a34ed9d`)

## 1) Branch health (vs `main`)

| Branch | Diff stats vs main | `pnpm build` | `npx vitest run` | Health |
|---|---:|---:|---:|---|
| `feat/story-context-capsules` | 11 files changed, 2482 insertions(+) | ✅ Pass | ✅ Pass | Ready (individually) |
| `feat/project-memory` | 12 files changed, 3014 insertions(+), 1 deletion(-) | ✅ Pass | ✅ Pass | Ready (individually) |
| `feat/dual-format-export` | 15 files changed, 4207 insertions(+) | ✅ Pass | ✅ Pass | Ready (individually) |
| `feat/spec-sharding` | 12 files changed, 2573 insertions(+) | ✅ Pass | ✅ Pass | Ready (individually) |
| `feat/e2e-testing-system` | 14 files changed, 3473 insertions(+), 1 deletion(-) | ✅ Pass | ✅ Pass | Ready (individually) |

## 2) Merge-order simulation

Requested simulation order:
1. capsules (`feat/story-context-capsules`)
2. memory (`feat/project-memory`)
3. export (`feat/dual-format-export`)
4. sharding (`feat/spec-sharding`)
5. e2e (`feat/e2e-testing-system`)

### Result
- ✅ Merge simulation `main` + `feat/story-context-capsules`: clean
- ❌ Next merge simulation `+ feat/project-memory`: conflicts detected

Conflicting files:
- `packages/cli/src/index.ts`
- `packages/core/src/index.ts`

Because the sequence blocks at step 2, downstream merges in this exact chain are **not merge-ready** until these conflicts are resolved.

## 3) Conflict notes

Likely cause:
- Both `story-context-capsules` and `project-memory` modify shared export/registration surfaces in:
  - CLI entrypoint (`packages/cli/src/index.ts`)
  - Core public API barrel/index (`packages/core/src/index.ts`)

Impact:
- Integration-level conflict (composition/export wiring), not branch-local build/test quality.
- Each branch is green in isolation, but stacked merge introduces overlap.

## 4) Recommended merge order

Recommended practical order (minimal change from requested):
1. `feat/story-context-capsules`
2. **resolve integration conflicts with** `feat/project-memory` (manual conflict resolution + re-run CI)
3. `feat/dual-format-export`
4. `feat/spec-sharding`
5. `feat/e2e-testing-system`

Rationale:
- Keeps intended sequence while explicitly adding a required integration checkpoint after step 1.
- All branches are currently healthy alone, so primary blocker is shared entrypoint reconciliation.

## 5) Blockers and required fixes

### Blockers
- Merge conflict at step 2 of requested sequence:
  - `packages/cli/src/index.ts`
  - `packages/core/src/index.ts`

### Required fixes
1. Manually resolve the two conflict files when merging `feat/project-memory` on top of `feat/story-context-capsules`.
2. Re-run:
   - `pnpm build`
   - `npx vitest run`
3. Continue remaining merges in order.

### CI-readiness tiny fixes applied
- None applied. No typos/docs/config-only fix was required to make branch-local build/tests pass.

---

### Verification commands used
- Diff stats: `git diff --shortstat main...<branch>`
- Build: `pnpm build`
- Tests: `npx vitest run`
- Merge simulation: temporary branch from `main` with sequential `git merge --no-ff --no-commit <branch>`
